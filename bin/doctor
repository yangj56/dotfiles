#!/usr/bin/env bash
set -euo pipefail

# Ensure brew and nvm are available (doctor often runs in bash, so .zshrc isn't loaded)
if [[ -x /opt/homebrew/bin/brew ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
elif [[ -x /usr/local/bin/brew ]]; then
  eval "$(/usr/local/bin/brew shellenv)"
fi
export NVM_DIR="${NVM_DIR:-$HOME/.nvm}"
[[ -s "$(brew --prefix nvm 2>/dev/null)/nvm.sh" ]] && source "$(brew --prefix nvm)/nvm.sh" 2>/dev/null || true

echo "ðŸ©º Dotfiles Doctor"
echo "------------------"

check() {
  command -v "$1" >/dev/null 2>&1 && echo "âœ” $1: $($2)" || echo "âœ˜ $1 missing"
}

check brew "brew --version | head -n1"
check git "git --version"
check node "node -v"
check nvm "nvm --version"
check fzf "fzf --version | head -n1"
check autojump "autojump --version"

[[ -L "$HOME/.zshrc" ]] && echo "âœ” .zshrc symlinked" || echo "âš  .zshrc not symlinked"
[[ -d "$HOME/.oh-my-zsh" ]] && echo "âœ” Oh My Zsh installed" || echo "âœ˜ Oh My Zsh missing"

echo "------------------"
echo "Doctor check complete"
